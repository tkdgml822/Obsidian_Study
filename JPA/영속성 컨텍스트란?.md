x# 영속성 컨텍스트란?
엔티티를 관리하는 가상의 공간 데이터베이스에서 효과적으로 데이터를 가져올 수 있고, 엔티티를 편하게 사용할 수 있음영속성 컨텍스트에는 1차 캐시, 쓰기 지연, 변경 감지, 지연 로딩이라는 특징이 있다.

## 1차 캐시

영속성 컨텍스트는 내부에 1차 캐시를 가지고 있다. 이때 캐시의 키는 엔티티의 @Id 애너테이션이 달린 키본키 역할을 하는 식별자이면 값은 엔티티이다. 앤티티를 조회하면 1차 캐시에서 데이터를 조회하고 값이 있으면 반환한다. 값이 없으면 데이터베이스에서 조회해 1차 캐시에 저장한 다음 반환한다. 이를 통해 캐시된 데이터를 조회할 때에는 데이터베이스를 거치지 않아도 되므로 매우 빠르게 데이터를 조회할 수 있습니다.

## 쓰기 지연

쓰기 지연은 트랜잭션을 커밋하기 전까지는 데이터베이스에 실제로 질의문을 보내지 않고 퀴리를 모았다가 트랜잭션을 커밋하면 모았던 퀴를 한번에 실행하는 것을 의미한다.예를 들어 데이터 추가 퀴리가 3개라면 영속성 컨텍스트는 트랜잭션을 커밋하는 시점에 3개의 쿼리를 한꺼번에 퀴리를 전송한다.적당한 묶음으로 퀴를 요청할 수 있어 데이터베이스 시스템의 부담을 줄일 수 있습니다.

## 변경 감지

트랜잭션을 커밋하면 1차 캐시에 저장되어 있는 엔티티의 값과 현재 엔티티의 값을 비교해서 변경된 값이 있다면 변경 사항을 감지해 변경된 값을 데이터베이스에 자동으로 반영합니다.이를 통해 쓰기 지연과 마찬가지로 적당한 묶음으로 퀴리를 요청할 수 있고, 데이터베이스 시스템을 부담을 줄일 수 있다.

## 지연 로딩

지연 로딩은 쿼리로 요청한 데이터를 애플리케이션에 바로 로딩하는 것이 아니라 필요할 때 퀴리를 날려 데이티를 조회하는 것을 의미한다.

이 특징들이 갖는 공톰점은 모두 데이터베이스의 접근을 최소화해 성능을 높일 수 있다는 것이다.캐시를 하거나, 자주 쓰지 않게 하거나, 변화를 자동 감지해서 미리 준비하거나 하는 등의 방법을 통해