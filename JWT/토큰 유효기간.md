만약 토큰을 주고받는 환경이 보안에 취약해서 토큰 자체가 노출되면 어떻게 될까요? 
토큰이 이미 발급되면 그 자체로 인증 수단이 되므로 서버는 토큰과 함께 들어온 요청이 토큰을 탈취한 사람의 요청인지 확인할 수 없습니다.

## 리프레시 토큰
토큰의 유효기간이 하루라면 어떨까요? 하루 동안은 그 토큰으로 무엇이든 할 수 있으므로 큰일입니다. 그러면 토큰의 유효기간 짧으면 되겠군요. 그렇지만 토큰의 유효기간이 짧으면 사용자 입장에서는 받은 토큰을 너무 짧은 시간만 활용할 수 있으니 불편합니다. 이러한 불편한 지점을 해결하기 리프레시 토큰이 등장합니다. 사용자를 인증하기 위한 용도가 아닌 액세스 토큰이 만료되었을 때 새로운 액세스 토큰을 발급하기 위해 사용한다.
액세스 토큰의 유효 기간을 짧게 설정하고 리프레시 토큰의 유효 기간을 길게 설정하면 공격갖가 액세스 토큰을 탈취해도 몇 분 뒤에는 사용할 수 없는 토큰이 되므로 더 안전한다.
![리프레시 토큰](JWT/image/리프레시_토큰.png)

1. 클라이언트 서버에 인증을 요청
2. 서버는 클라이언트에서 전달한 정보를 바탕으로 인증 정보가 유효한지 확인한 뒤, 액세스 토큰과 리프레시 토큰을 만들어 클라이언트에게 전달 한다.
3. 서버에서 생성한 리프레시 토큰은 DB에도 저장
4. 인증을 필요로 하는 API를 호출할 때 클라이언트에 저장된 액세스 토큰과 함께 API를 요청합니다.
5. 서버는 전달받은 액세스 토큰이 유효한지 검사한 뒤에 유효하다면 클라이언트에서 요청한 내용을 처리
6. 시간이 지나고 액세스 토큰이 만료 클라이언트에서 원하는 정보를 얻기 위해 서버에서 API 요청을 보냄
7. 서버는 액세스 토큰이 유효한지 검사한다. 만료된 토큰이면 유효하지 않기 때문에 토큰이 만료되었다는 에러를 전달
8. 클라이언트는 이 응답을 받고 저장해둔 리프레시 토큰과 함께 새로운 액세스 토큰을 발급하는 요청을 전송
9. 서버는 전달받은 리프레시 토큰이 유효한지, DB에서 리프레시 토큰을 조회한 후 저정해둔 리프레시 토큰과 같은지 응답
10. 만약 유효한 리프레시 토큰이면 새로운 액세스 토큰을 생성한 뒤 응답. 그 이후로 4번과 같이 다시 API를 요청합니다.